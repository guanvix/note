#### 硬盘

- **硬件组成**  
  - **机械盘**  
    - **盘片**  
      <small>是硬盘中承载数据存储的介质,一个磁盘由多个盘片(disk)组成。</small>
    - 磁道  
      <small>当磁盘旋转时,磁头若保持在一个位置上,则每个磁头都会在磁盘表面划出一个圆形轨迹,这些圆形轨迹就叫做磁道(Track)。</small>
    - **扇区**  
      <small>磁盘上的每个磁道被等分为若干个弧段,这些弧段便是硬盘的扇区(Sector)。硬盘的第一个扇区,叫做引导扇区。</small>
    - **柱面** 
      <small>在有多个盘片构成的盘组中,由不同盘片的面,但处于同一半径圆的多个磁道组成的一个圆柱面(Cylinder)。</small> 
    - **磁头**
      <small>是硬盘读取数据的关键部件,它的主要作用就是将存储在硬盘盘片上的磁信息转化为电信号向外传输,而它的工作原理则是利用特殊材料的电阻值会随着磁场变化的原理来读写盘片上的数据,磁头的好坏在很大程度上决定着硬盘盘片的存储密度。</small>
  - **固态盘**  
    - **主控**  
      <small>主控芯片是固态硬盘的大脑，地位作用与电脑中的CPU相似，是整个固态硬盘的核心器件。其作用一是合理调配数据在各个闪存芯片上的负荷，二则是承担了整个数据中转，连接闪存芯片和外部SATA接口。</small>
    - **硬盘颗粒**  
      - **SLC**  
        <small>单层单元,每个Cell单元存储1bit信息,也就是只有0、1两种电压变化,结构简单,电压控制也快速,反映出来的特点就是寿命长,性能强,P/E寿命在1万到10万次之间,但缺点就是容量低而成本高,毕竟一个Cell单元只能存储1bit信息。</small>
      - **MLC**
        <small>多层单元,每个cell单元存储2bit信息,需要更复杂的电压控制,有00,01,10,11四种变化,这也意味着写入性能、可靠性能降低了。其P/E寿命根据不同制程在3000-5000次不等。</small>
      - **TLC**  
        <small>三层单元,每个cell单元存储3bit信息,电压从000到001有8种变化,容量比MLC再次增加1/3,成本更低,但是架构更复杂,P/E编程时间长,写入速度慢,P/E寿命也降至1000-3000次,部分情况会更低。寿命短只是相对而言的,通常来讲,经过重度测试的TLC颗粒正常使用5年以上是没有问题的。</small>  
    
        |<small>架构</small>|<small>存储密度</small>|<small>擦写寿命</small>|<small>保存时间</small>|<small>读写速度</small>|<small>主控要求</small>|
        |:---:|:---:|:---:|:---:|:---:|:---:|
        |<small>SLC</small>|<small>最低</small>|<small>高</small>|<small>较长</small>|<small>快</small>|<small>低</small>|
        |<small>MLC</small>|<small>中等</small>|<small>中</small>|<small>较长</small>|<small>中</small>|<small>中</small>|
        |<small>SLC</small>|<small>最高</small>|<small>一般</small>|<small>较长</small>|<small>慢</small>|<small>高</small>|
    - **存储介质**  
      - **NAND**  
        <small>一种非易失性存储技术,即断电后仍能保存数据。其目标就是降低每比特存储成本、提高存储容量。</small>
      - **DRAM**  
        <small>动态随机存取存储器。DRAM只能将数据保持很短的时间。为了保持数据, DRAM使用电容存储,所以必须隔一段时间刷新。</small>

- **接口**  
  - **机械盘**  
    - **IDE**  
      <small>优点：易于使用与价格低廉,问世后成为最为普及的磁盘接口。</small>
      <small>缺点：速度慢,只能内置使用,对接口电缆的长度有很严格的限制。</small>
    - **SCSI**  
      <small>小型计算机系统接口。</small>
      <small>优点：SCSI接口具有应用范围广泛、强大灵活的连接方式。
                   &emsp;&emsp;&emsp;高性能(具有很多任务、带宽大、及少CPU占用率、热插拔等特点)。
                   &emsp;&emsp;&emsp;具有外置和内置两种。</small>
      <small>缺点：价格昂贵、安装复杂、扩展性差。</small>
    - **SATA**  
      <small>串口硬盘</small>
      <small>优点：传输速率高，可靠性好。</small>
    - **SAS**  
      <small>串行连接SCSI，是新一代的SCSI技术，和现在流行的Serial ATA(SATA)硬盘相同，都是采用串行技术以获得更高的传输速度，并通过缩短连结线改善内部空间等。</small>
      <small>优点：速度快，抗干扰能力强。</small>
      <small>缺点：价格昂贵。</small>
  - **固态盘**  
    - **SATA**  
    - **SAS**  
    - **PCIE**  
      <small>数据直接通过总线与CPU直连，省去了内存调用硬盘的过程，传输效率与速度都成倍提升。</small>
    - **NVME**

- **主要技术参数**  
  - **单碟容量**  
    <small>硬盘是由多个存储碟片组合而成的，而单碟容量就是一个存储碟所能存储的最大数据量。</small>
  - **转速**  
    <small>是硬盘内电机主轴的旋转速度，也就是硬盘盘片在一分钟内所能完成的最大转数。转速的快慢是标示硬盘档次的重要参数之一，它是决定硬盘内部传输率的关键因素之一，在很大程度上直接影响到硬盘的速度。</small>
  - **寻道时间/平均访问时间**  
    <small>平均寻道时间是指MO磁光盘机在接收到系统指令后，磁头从开始移动到移动到数据所在磁道所需要的平均时间，它是指计算机在发出一个寻址命令，到相应目标数据被找到所需时间，单位为毫秒(ms)。</small>
  - **平均等待时间**  
    <small>数据所在的扇区转到磁头下的平均时间。</small>
  - **外部传输速率**  
    <small>硬盘缓存和电脑系统之间的数据传输率，也就是计算机通过硬盘接口从缓存中将数据读出交给相应的控制器的速率。</small>
  - **内部传输速率**   
    <small>硬盘将数据从盘片上读取出来，然后存储在缓存内的速度。内部传输率可以明确表现出硬盘的读写速度，它的高低才是评价一个硬盘整体性能的决定性因素，它是衡量硬盘性能的真正标准。</small>
  - 硬盘缓存
    <small>磁盘缓存，又称磁盘快取，实际上就是将下载到的数据先保存于系统为软件分配的内存空间中（这个内存空间被称之为“内存池”），当保存到内存池中的数据达到一个程度时，便将数据保存到硬盘中。这样可以减少实际的磁盘操作，有效的保护磁盘免于重复的读写操作而导致的损坏。</small>

- **MBR**  
  <small>主分区引导记录。</small>
  <small>MBR支持32位和64位系统。</small>
  <small>MBR支持分区数量有限。</small>
  <small>MBR只支持不超过2T的硬盘，超过2T的硬盘将只能用2T空间。</small>
- **GPT**
  <small>GUID分区表，即全局唯一标识磁盘分区表，它是UEFI 规范的一部分。</small>
  <small>支持超过2T的磁盘（64位寻址空间）。fdisk最大只能建立2TB大小的分区，创建一个大于2TB的分区使用parted。向后兼容MBR。</small>
  <small>必须在支持uEFI的硬件上才能使用。</small>
  <small>必须使用64位系统。</small>

  > <small>Mac、Linux系统都能支持GPT分区格式。Windows 7/8 64bit、Windows Server 2008 64bit支持GPT。</small>

- **分区**  

- **机械盘VS固态盘**  
  <small>
  |类型|存取速率|写入速度|防震|功耗|成本|寿命|可靠性|
  |:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
  |机械硬盘|不如固态硬盘|不如固态硬盘|弱|高|低|长|高|
  |固态硬盘|快|快|强|低|高|不如机械硬盘|不如机械硬盘|
  </small>
  <small>本质不同：机械硬盘本质是电磁存储，固态则是半导体存储。</small>
  <small>防震抗摔性不同：机械硬盘很怕率，固态抗震。</small>
  <small>数据存储速度不同：固态读写速度比机械快。</small>
  <small>功耗不同：固态硬盘的功耗比机械硬盘低。</small>
  <small>重量不同：固态硬盘的重量比机械硬盘轻。</small>
  <small>噪音不同：机械硬盘有噪音，固态硬盘没有噪音。</small>

- **性能及测试**
  - **IOPS**  
    <small>是一个用于计算机存储设备（如硬盘（HDD）、固态硬盘（SSD）或存储区域网络（SAN））性能测试的量测方式，可以视为是每秒的读写次数。</small>
  - **MBPS**

- **NVME硬盘原理**
    <img src="https://pic1.zhimg.com/80/v2-f2b9944a36122da6b196229efa544518_720w.jpg">  
    <small>上图为NVMe白皮书中的配图，这里主机称为Host，而NVMe设备称为Controller（控制器）。主机和控制器之间通过共享内存的队列实现交互。</small>
    <small>NVMe的队列分为2种，其中一种是用于管理的队列，称为Admin Queue（管理队列），仅有一个，另外一种是命令队列（Command Queue），最多可以有65535个。其中命令队列的数量和模式都是通过管理队列来设置的。其中每一个队列实际上是一个队列对，也就是包括两个队列，分别是提交队列（Submission Queue）和完成队列（Completion Queue）。提交队列用于主机端向NVMe设备发送NVMe命令，而完成队列则用于NVMe设备向主机反馈命令执行情况。</small>
    > <small>详情见 [理解NVMe的内部实现原理，这一篇就够了](https://zhuanlan.zhihu.com/p/71932654)

- **SATA协议**  
- **SAS协议**